#include<bits/stdc++.h>
using namespace std;
#define ll long long
const int maxn=1000010;
int n,a[maxn],b[maxn],s[maxn];
ll ans;
vector<int> v[maxn];
void solve(int x)
{
      int top=0;
      queue<int> q;
      q.push(x);
      while(!q.empty())
      {
            int r=q.front(); q.pop();
            s[top++]=r;
            for(int i=0; i<v[r].size(); i++) q.push(v[r][i]);
      }
      while(top--)
      {
            vector<int> t;
            int y=s[top];
            for(int i=0; i<v[y].size(); i++) t.push_back(a[v[y][i]]);
            sort(t.begin(),t.end());
            int l=0;
            for(int i=0; i<t.size(); i++) ans+=l,l+=t[i];
            a[y]+=l;
      }
}
int main()
{
      scanf("%d",&n);
      for(int i=0; i<n; i++)
      {
            scanf("%d%d",a+i,b+i);
            if(b[i]!=-1)
                  v[b[i]].push_back(i);
            else v[n].push_back(i);
      }
      for(int i=0; i<v[n].size(); i++) solve(v[n][i]);
      printf("%lld\n",ans);
      return 0;
}
